---
title: "クラスタアップデートについて学習"
date: 2023-09-27T22:41:54+09:00
draft: false
tags:
  - kubernetes
toc: true
---
<!--more-->
kubernetesは最新バージョンからマイナーバージョンで三世代前までをサポートする。三世代アップデートされる期間としてはおおよそ90日。
kubernetesのクラスタアップデートの方法としては、マスターノードを最初に行い、ワーカーノードをその次に行うという方法が取れる。ワーカーノードはマスターノードが停止している期間も動き続けるため、サービスを停止せずに行うことも可能である。
バージョンアップは一世代ずつ行う
drainを利用し、新たにノードにポッドがスケジュールされないようにする。またdrainを使い、更新対象のワーカーノードからポッドを排出し、別のワーカーノードへポッドを乗せ換えることでクラスタアップデート中でもサービスの提供を継続できる。
aptコマンドで新しいバージョンのkubeadm,kubeletをインストールする。インストールする際にはバージョン指定を行う。
ワーカーノードのアップグレードの際はsshでワーカーノードに入り、kubeadm upgrade nodeでアップグレードを行う

# 参考
- 
