---
title: "Chartバージョンを指定してインストール/アップグレードする"
date: 2024-03-02T00:26:15+09:00
draft: false
tags:
  - Kubernetes
toc: true
---
最近helmコマンドでupgradeをしたとき、意図せずバージョンを上げてしまい、サービスが動かなくなってしまったことあったのでバージョンを指定してインストールする方法を残しておきます。
<!--more-->
バージョンを上げてしまったのは、新しくhelmのリポジトリを追加しようとしたとき、```helm repo update```を行ったからでした。これにより既に登録してあるリポジトリのバージョンの更新が行われ、特にバージョンを指定しない限り、登録してあるすべてのリポジトリで最新バージョンのChartを利用してインストール/アップグレードをすることになります。    
最新バージョンで更新を行いたくない場合、以下のコマンドで更新を行います。  
```helm upgrade <release> <Chart> --version=<Chart version> ```  
これにより、指定したバージョンのチャートをベースとして更新を行うことができます

# 感想
いつもどおり更新を行ったはずなのに、なぜかサービスが動かなくなってしまったため、最初何が起こったかわかりませんでした。
このようなことが再び起こらないように、helmfileを導入してより宣言的にChartを管理していこうかなと思いました。
